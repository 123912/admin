import{b3 as f,a as K,r as u,O as Q,o as W,av as X,f as b,s as U,y as a,w as r,R as k,k as d,j as C,a$ as T,g as Z,F as ee,ak as h,b5 as p,b0 as ae,S as te,U as le,E as oe,V as re,Y as ne}from"./index-537f057f.js";import{E as se}from"./el-dialog-572bb7ad.js";import"./el-overlay-80a7d957.js";import{E as ie}from"./el-progress-472b4673.js";/* empty css                */import{E as de}from"./el-pagination-557c4079.js";import{E as me,a as ue,b as ce}from"./el-table-column-efe7b014.js";/* empty css                   */import{E as pe}from"./el-button-caa9e001.js";import"./refs-044d52ff.js";import"./vnode-4c4dc2d3.js";const _e=(m,s)=>f.get(`/admin/product/baseTrademark/${m}/${s}`),ge=m=>m.id?f.put("/admin/product/baseTrademark/update",m):f.post("/admin/product/baseTrademark/save",m),fe=m=>f.delete("/admin/product/baseTrademark/remove/"+m),ve=["src"],ye=["src"],be={class:"dialog-footer"},ke=K({__name:"index",setup(m){const s=u(1),v=u(3),N=u(!0),V=u(!0);let E=u(0),y=u([]),i=u(!1),l=Q({tmName:"",logoUrl:""}),c=u();const _=async(e=1)=>{s.value=e;let t=await _e(s.value,v.value);t.code==200&&(E.value=t.data.total,y.value=t.data.records)};W(()=>{_()});const z=e=>{s.value=1,console.log(`${e} items per page`),_()},w=e=>{console.log(`current page: ${e}`),_(e)},O=()=>{i.value=!0,l.id=0,l.tmName="",l.logoUrl="",h(()=>{c.value.clearValidate("tmName"),c.value.clearValidate("logoUrl")})},P=e=>{h(()=>{c.value.clearValidate("tmName"),c.value.clearValidate("logoUrl")}),i.value=!0,Object.assign(l,e)},$=async()=>{await c.value.validate();let e=await ge(l);console.log("result",e),e.code==200?(i.value=!1,p({message:l.id?"修改品牌成功":"添加品牌成功",type:"success"}),_(l.id?s.value:1)):p({message:l.id?"修改品牌失败":"添加品牌失败",type:"error"})},q=e=>{if(e.type=="image/jpeg"||e.type=="image/png"||e.type=="image/gif"){if(e.size/1024/1024>4)return p.error("Avatar picture size can not exceed 2MB!"),!1}else return p.error("Avatar picture must be JPG|png|gif format!"),!1},A=e=>{l.logoUrl=e.data,c.value.clearValidate("logoUrl")},B={tmName:[{required:!0,trigger:"blur",validator:(e,t,n)=>{t.trim().length>=2?n():n(new Error("品牌名称位数大于等于两位"))}}],logoUrl:[{required:!0,trigger:"change",validator:(e,t,n)=>{t?n():n(new Error("LOGO的图片务必上传"))}}]},L=async e=>{(await fe(e)).code==200?(p({message:"删除品牌成功",type:"success"}),_(y.value.length>1?s.value:s.value-1)):p({message:"删除品牌失败",type:"error"})};return(e,t)=>{const n=pe,g=me,M=ue,S=ce,j=de,D=ae,G=te,x=le,I=X("Plus"),R=oe,F=ie,H=re,J=se;return b(),U(ee,null,[a(D,{class:"box-card"},{default:r(()=>[a(n,{type:"primary",size:"default",icon:"Plus",onClick:O},{default:r(()=>[k("添加品牌")]),_:1}),a(S,{data:d(y),border:"",style:{width:"100%",margin:"10px 0"}},{default:r(()=>[a(g,{prop:"date",type:"index",align:"center",label:"序号",width:"80"}),a(g,{prop:"tmName",align:"center",label:"品牌名称"}),a(g,{align:"center",label:"品牌LOGO"},{default:r(({row:o})=>[C("img",{style:{width:"60px",height:"60px"},src:o.logoUrl,alt:""},null,8,ve)]),_:1}),a(g,{align:"center",label:"品牌操作"},{default:r(({row:o})=>[a(n,{type:"primary",size:"small",icon:"Edit",onClick:Y=>P(o)},null,8,["onClick"]),a(M,{title:`您确认要删除${o.tmName}?`,width:"250px",icon:"Delete",onConfirm:Y=>L(o.id)},{reference:r(()=>[a(n,{type:"primary",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),a(j,{"current-page":s.value,"onUpdate:currentPage":t[0]||(t[0]=o=>s.value=o),"page-size":v.value,"onUpdate:pageSize":t[1]||(t[1]=o=>v.value=o),"page-sizes":[3,5,7,9],small:N.value,background:V.value,layout:"prev, pager, next,jumper,-> ,sizes,total",total:d(E),onSizeChange:z,onCurrentChange:w},null,8,["current-page","page-size","small","background","total"])]),_:1}),a(J,{modelValue:d(i),"onUpdate:modelValue":t[4]||(t[4]=o=>T(i)?i.value=o:i=o),title:d(l).id?"修改品牌":"添加品牌"},{footer:r(()=>[C("span",be,[a(n,{onClick:t[3]||(t[3]=o=>T(i)?i.value=!1:i=!1)},{default:r(()=>[k("取消")]),_:1}),a(n,{type:"primary",onClick:$},{default:r(()=>[k(" 确定 ")]),_:1})])]),default:r(()=>[a(H,{model:d(l),rules:B,ref_key:"formRef",ref:c,style:{width:"80%"}},{default:r(()=>[a(x,{label:"品牌名称","label-width":"100px",prop:"tmName"},{default:r(()=>[a(G,{modelValue:d(l).tmName,"onUpdate:modelValue":t[2]||(t[2]=o=>d(l).tmName=o),placeholder:"请输入品牌名称"},null,8,["modelValue"])]),_:1}),a(x,{label:"品牌LOGO","label-width":"100px",prop:"logoUrl"},{default:r(()=>[a(F,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":A,"before-upload":q},{default:r(()=>[d(l).logoUrl?(b(),U("img",{key:0,src:d(l).logoUrl,class:"avatar"},null,8,ye)):(b(),Z(R,{key:1,class:"avatar-uploader-icon"},{default:r(()=>[a(I)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}});const qe=ne(ke,[["__scopeId","data-v-c86d4415"]]);export{qe as default};
