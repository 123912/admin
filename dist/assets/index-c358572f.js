import{a as R,r as V,O as M,bc as G,a5 as H,bd as K,ar as Q,f as _,s as k,y as e,k as n,w as a,h as E,j as L,R as p,F as x,ad as W,g as I,t as A,v as z,be as X,b5 as f,ak as B,bf as Y,bg as Z,bh as ee,S as te,U as ae,V as le,b0 as se}from"./index-537f057f.js";import{E as re,a as ne,b as oe}from"./el-table-column-efe7b014.js";/* empty css                   */import{E as ie}from"./el-button-caa9e001.js";const ce=["onClick"],ye=R({__name:"index",setup(de){let g=V([]),d=V(0),b=V([]),t=M({attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),m=G();H(()=>m.c3Id,()=>{g.value=[],m.c3Id&&v()});const v=async()=>{const{c1Id:s,c2Id:o,c3Id:y}=m;let r=await K(s,o,y);r.code==200&&(g.value=r.data)},S=()=>{Object.assign(t,{attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),d.value=1,t.categoryId=m.c3Id},O=s=>{d.value=1,Object.assign(t,JSON.parse(JSON.stringify(s)))},U=async s=>{(await X(s)).code==200?(f({type:"success",message:"删除成功"}),v()):f({type:"error",message:"删除失败"})},N=()=>{d.value=0},$=()=>{t.attrValueList.push({valueName:"",flag:!0}),B(()=>{b.value[t.attrValueList.length-1].focus()})},w=async()=>{(await Y(t)).code==200?(d.value=0,f({type:"success",message:t.id?"修改成功":"添加成功"}),v()):f({type:"error",message:t.id?"修改失败":"添加失败"})},D=(s,o)=>{if(s.valueName.trim()==""){t.attrValueList.splice(o,1),f({type:"error",message:"属性值不能为空"});return}if(t.attrValueList.find(r=>{if(r!=s)return r.valueName===s.valueName})){t.attrValueList.splice(o,1),f({type:"error",message:"属性值不能重复"});return}s.flag=!1},T=(s,o)=>{s.flag=!0,B(()=>{b.value[o].focus()})};return Q(()=>{m.$reset()}),(s,o)=>{const y=Z,r=ie,u=re,F=ee,P=ne,C=oe,h=te,j=ae,q=le,J=se;return _(),k(x,null,[e(y,{scene:n(d)},null,8,["scene"]),e(J,{style:{margin:"10px 0"}},{default:a(()=>[E(L("div",null,[e(r,{onClick:S,type:"primary",size:"default",icon:"Plus",disabled:!n(m).c3Id},{default:a(()=>[p("添加属性")]),_:1},8,["disabled"]),e(C,{data:n(g),border:"",style:{width:"100%",margin:"10px 0"}},{default:a(()=>[e(u,{label:"序号",type:"index",width:"80",align:"center"}),e(u,{prop:"attrName",width:"120",label:"属性名称"}),e(u,{prop:"address",label:"属性值名称"},{default:a(({row:l,$index:c})=>[(_(!0),k(x,null,W(l.attrValueList,(i,ue)=>(_(),I(F,{style:{margin:"5px"},key:i.id},{default:a(()=>[p(A(i.valueName),1)]),_:2},1024))),128))]),_:1}),e(u,{prop:"address",width:"120",label:"操作"},{default:a(({row:l})=>[e(r,{type:"primary",size:"small",icon:"Edit",onClick:c=>O(l)},null,8,["onClick"]),e(P,{title:`您确认要删除${l.attrName}?`,width:"250px",icon:"Delete",onConfirm:c=>U(l.id)},{reference:a(()=>[e(r,{type:"primary",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])],512),[[z,n(d)==0]]),E(L("div",null,[e(q,{inline:!0},{default:a(()=>[e(j,{label:"属性名称"},{default:a(()=>[e(h,{placeholder:"请输入属性名称",modelValue:n(t).attrName,"onUpdate:modelValue":o[0]||(o[0]=l=>n(t).attrName=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{disabled:!n(t).attrName,type:"primary",size:"default",icon:"Plus",onClick:$},{default:a(()=>[p("添加属性值")]),_:1},8,["disabled"]),e(r,{type:"primary",size:"default",onClick:N},{default:a(()=>[p("取消")]),_:1}),e(C,{border:"",style:{margin:"10px 0"},data:n(t).attrValueList},{default:a(()=>[e(u,{label:"序号",type:"index",width:"80",align:"center"}),e(u,{label:"属性值名称"},{default:a(({row:l,$index:c})=>[l.flag?(_(),I(h,{key:0,ref:i=>n(b)[c]=i,onBlur:i=>D(l,c),size:"samll",placeholder:"请输入属性值名称",modelValue:l.valueName,"onUpdate:modelValue":i=>l.valueName=i},null,8,["onBlur","modelValue","onUpdate:modelValue"])):(_(),k("div",{key:1,onClick:i=>T(l,c)},A(l.valueName),9,ce))]),_:1}),e(u,{label:"属性值操作"},{default:a(({row:l,$index:c})=>[e(r,{type:"primary",size:"small",onClick:i=>n(t).attrValueList.splice(c,1),icon:"Delete"},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),e(r,{disabled:!(n(t).attrValueList.length>0),type:"primary",size:"default",onClick:w},{default:a(()=>[p("保存")]),_:1},8,["disabled"]),e(r,{type:"primary",size:"default",onClick:N},{default:a(()=>[p("取消")]),_:1})],512),[[z,n(d)==1]])]),_:1})],64)}}});export{ye as default};
